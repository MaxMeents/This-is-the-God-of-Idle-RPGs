<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>God of Idle RPGs - Multi-Stage Combat</title>
    <script src="https://cdn.jsdelivr.net/npm/pixi.js@8.14.2/dist/pixi.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/clusterize.js@0.18.1/clusterize.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/clusterize.js@0.18.1/clusterize.css">
    <!-- Main styles for the HUD and Layout -->
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Outfit:wght@400;700;900&family=Tektur:wght@400;700;900&family=Silkscreen:wght@400;700&family=Press+Start+2P&family=Bungee&family=Monoton&family=Righteous&family=Russo+One&family=Wallpoet&family=Audiowide&family=Syncopate:wght@400;700&family=Michroma&family=Stalinist+One&family=Racing+Sans+One&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/loot.css">

    <!-- MODULAR SYSTEM STYLES -->
    <link rel="stylesheet" href="css/base/electricity.css">
    <link rel="stylesheet" href="css/base/global.css">
    <link rel="stylesheet" href="css/base/animations.css">
    <link rel="stylesheet" href="css/hud/player-vitals.css">
    <link rel="stylesheet" href="css/hud/ammo-systems.css">
    <link rel="stylesheet" href="css/hud/speed-controls.css">
    <link rel="stylesheet" href="css/hud/skill-buttons.css">
    <link rel="stylesheet" href="css/hud/stage-nav.css">
    <link rel="stylesheet" href="css/hud/location-display.css">
    <link rel="stylesheet" href="css/hud/target-hud.css">
    <link rel="stylesheet" href="css/hud/radar.css">
    <link rel="stylesheet" href="css/hud/pause-overlay.css">
    <link rel="stylesheet" href="css/loot/loot-stairs.css">
    <link rel="stylesheet" href="css/loot/loot-ledger.css">
    <link rel="stylesheet" href="css/hud/training-sim.css"> <!-- NEW: Simulation UI -->
    <link rel="stylesheet" href="css/modals/base-modal.css">

</head>

<body>
    <!-- LAYERED BACKGROUND SYSTEM -->
    <div id="floor-overlay"></div>
    <div id="electricity-mount"></div> <!-- Mount point for the dynamic JS canvas -->

    <!-- Splash screen while assets are baking in the background -->
    <div id="loading-screen">
        <div id="loading-content">
            <h1 id="game-title">GOD OF IDLE RPGs</h1>
            <div id="progress-container">
                <div id="progress-bar"></div>
            </div>
            <div id="loading-status">Synchronizing Combat Data...</div>
            <button id="start-game-btn" style="display: none;">BEGIN COMBAT</button>
        </div>
    </div>

    <!-- HUD Overlay -->
    <div id="ui">
        <div id="fps" class="stat">FPS: 0</div>
    </div>

    <!-- TRAINING SIMULATION OVERLAY -->
    <div id="training-sim-overlay">
        <button id="close-sim-btn">×</button>
        <div class="sim-container">
            <!-- LEFT: SECTORS -->
            <div class="sim-sectors" id="sim-sectors-list">
                <!-- Generated via JS -->
            </div>

            <!-- CENTER: SUB-GRID -->
            <div class="sim-grid-container">
                <div class="sim-header">
                    <div>
                        <div class="sim-subtitle">TRAINING PROTOCOL</div>
                        <div class="sim-title" id="sim-sector-title">SECTOR 1: GENESIS</div>
                    </div>
                </div>
                <div class="sim-grid" id="sim-level-grid">
                    <!-- Generated via JS -->
                </div>
            </div>

            <!-- RIGHT: COMMAND DECK -->
            <div class="sim-command-deck">
                <div class="sim-viewport">
                    <canvas id="sim-preview-canvas"></canvas>
                    <div class="preview-overlay-ui">LIVE FEED // SIM_844</div>
                </div>

                <div class="sim-info">
                    <h2 id="sim-level-name" style="margin: 0; font-family: 'Tektur'; font-size: 24px;">SELECT LEVEL</h2>
                </div>

                <div class="sim-stats">
                    <div class="stat-row">
                        <span class="stat-label">ENEMY COUNT</span>
                        <span class="stat-val" id="sim-enemy-count">--</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">DAMAGE EST.</span>
                        <span class="stat-val" id="sim-dmg-est">--</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">REWARD MULTIPLIER</span>
                        <span class="stat-val gold" id="sim-reward-mult">--</span>
                    </div>
                </div>

                <div class="sim-drops">
                    <div class="stat-label" style="margin-bottom: 8px;">EXPECTED DROPS</div>
                    <div id="sim-drops-list" class="drops-container"></div>
                </div>

                <!-- DIFFICULTY NODES -->
                <div class="difficulty-selector" id="sim-difficulty-selector">
                    <!-- Generated via JS -->
                </div>

                <button id="engage-btn"><span class="alive-text">ENGAGE SIMULATION</span></button>
            </div>
        </div>
    </div>

    <!-- LOCATION DISPLAY: Cinematic title for the current zone -->
    <div id="location-display"><span></span></div>

    <!-- STAGE NAVIGATION: Controls the switching between stages 1-9 -->
    <div id="stage-nav">
        <div id="nav-left" class="nav-arrow disabled">◀</div>
        <div id="stage-display">
            <div class="stage-main">Stage 1 - 0/300</div>
            <div class="stage-sub"></div>
        </div>
        <div id="nav-right" class="nav-arrow disabled">▶</div>
    </div>

    <!-- CHALLENGE BUTTON: Appears when a stage is cleared but user hasn't moved on -->
    <button id="challenge-btn">CHALLENGE NEXT STAGE</button>

    <!-- BOSS HUD: Reserved for Stage 10 encounters -->
    <div id="boss-health-container">
        <div id="boss-health-bar"></div>
    </div>

    <!-- OPEN SIM BUTTON (Top Left near Stats) -->
    <button id="open-sim-btn" style="
        position: fixed; 
        top: 80px; 
        left: 20px; 
        z-index: 1000;
        background: rgba(0,0,0,0.8);
        border: 1px solid #4169E1;
        color: #4169E1;
        padding: 8px 16px;
        font-family: 'Tektur';
        border-radius: 4px;
        cursor: pointer;
        transition: 0.2s;
    ">OPEN SIMULATION</button>

    <!-- MAIN PLAYER CORE HUD (BOTTOM LEFT) -->
    <div id="hud-left-corner">
        <!-- Shield Cooldown Ticker: Small white bar showing when shield is ready -->
        <div id="shield-charge-container">
            <div id="shield-charge-bar"></div>
        </div>

        <!-- Main Health Column: Large vertical bar with dynamic color -->
        <div id="player-health-container">
            <div id="player-health-ghost"></div>
            <div id="player-health-bar"></div>
            <!-- Shield HP Layer: Appears over the health when active -->
            <div id="player-shield-bar"></div>
        </div>

        <!-- NEW: Dedicated Resource Bars for Specialized Weaponry -->
        <div id="laser-ammo-container" class="skinny-bar">
            <div id="laser-ammo-bar"></div>
        </div>

        <div id="bullet-ammo-container" class="skinny-bar">
            <div id="bullet-ammo-bar"></div>
        </div>
    </div>

    <!-- TARGET HUD (Bottom Center) -->
    <div id="target-hud-container" style="display: none;">
        <div id="target-name">TARGET NAME</div>
        <div id="target-health-bg">
            <div id="target-health-ghost"></div>
            <div id="target-health-bar"></div>
        </div>
    </div>

    <!-- GAME SPEED INTERFACE: Allows user to multiply simulation speed (0.1x to 25x) -->
    <div id="speed-ctrl-container">
        <div class="speed-label">
            <span>GAME SPEED</span>
            <span id="speed-val">1.0x</span>
        </div>
        <input type="range" id="speed-slider" min="0.1" max="25" step="0.1" value="1.0">

        <!-- AUTO SKILL TOGGLE -->
        <div id="auto-btn-container">
            <div id="auto-btn" class="active">AUTO</div>
        </div>
    </div>

    <!-- SKILL ACTIVATION: Three tiers of power -->
    <div id="skill-buttons-rack">
        <div id="skill-button-container-1" class="skill-btn-wrapper">
            <canvas id="skill-button-canvas-1"></canvas>
        </div>
        <div id="skill-button-container-2" class="skill-btn-wrapper">
            <canvas id="skill-button-canvas-2"></canvas>
        </div>
        <div id="skill-button-container-3" class="skill-btn-wrapper">
            <canvas id="skill-button-canvas-3"></canvas>
        </div>
        <!-- SWORD OF LIGHT BUTTON -->
        <div id="skill-button-container-4" class="skill-btn-wrapper sword-of-light-btn">
            <canvas id="skill-button-canvas-4"></canvas>
        </div>
    </div>

    <!-- 
         GAME ENGINES & COMPONENT MODULES
         -------------------------------------------------------------------------
         ATTENTION FUTURE AI DEVELOPERS:
         DO NOT DELETE THE COMMENTS in these scripts or this HTML file. 
         They provide critical context for the modular architecture.
         When making changes, ADD YOUR OWN COMMENTS explaining WHY you made the change.
         -------------------------------------------------------------------------
    -->

    <!-- 1. CORE DEFINITIONS & INFRASTRUCTURE (Load these first!) -->
    <script src="js/core/config/performance-config.js"></script>
    <script src="js/core/config/ship-config.js"></script>
    <script src="js/core/config/skill-config.js"></script>
    <script src="js/core/config/weapon-config.js"></script>
    <script src="js/core/config/stage-config.js"></script>
    <script src="js/core/config/combat-config.js"></script>
    <script src="js/core/config/loot-config.js"></script>
    <script src="js/core/config/world-config.js"></script>
    <script src="js/core/enemies.js"></script>
    <script src="js/core/state.js"></script>
    <script src="js/core/utils.js"></script>
    <script src="js/systems/rendering/asset-registry.js"></script>
    <script src="js/systems/rendering/asset-loader.js"></script>

    <!-- 2. SYSTEM MODULES (Depends on Infrastructure) -->
    <script src="js/systems/rendering/particle-system.js"></script>
    <script src="js/systems/rendering/texture-baker.js"></script>
    <script src="js/systems/rendering/lod-manager.js"></script>
    <script src="js/systems/rendering/pixi-renderer.js"></script>

    <script src="js/systems/combat/projectile-engine.js"></script>

    <!-- LOOT SYSTEM: Must load BEFORE damage-processor.js -->
    <!-- Reason: damage-processor.js calls handleEnemyDrop() on enemy death -->
    <script src="js/systems/loot/loot-persistence.js"></script>
    <script src="js/systems/loot/loot-logic.js"></script>
    <script src="js/systems/loot/loot-ui.js"></script>
    <script src="js/systems/loot/loot-renderer.js"></script>
    <script src="js/systems/loot/loot-filters.js"></script>
    <script src="js/systems/loot/loot-batching.js"></script>

    <script src="js/systems/combat/damage-processor.js"></script>
    <script src="js/systems/combat/player-movement.js"></script>
    <script src="js/systems/combat/enemy-ai.js"></script>
    <script src="js/systems/combat/skills-system.js"></script>
    <script src="js/systems/combat/combat-core.js"></script>

    <!-- 3. UI SYSTEM (Depends on game state) -->
    <script src="js/systems/ui/ui-cache.js"></script>
    <script src="js/systems/ui/ui-orchestrator.js"></script>
    <script src="js/systems/ui/ui-listeners.js"></script>
    <script src="js/systems/ui/radar-system.js"></script>
    <!-- MOUSE EFFECTS (AAA Visuals) -->
    <script src="js/systems/ui/mouse-effects.js"></script>
    <!-- SETTINGS SYSTEM (AAA UI) -->
    <link rel="stylesheet" href="css/hud/settings-modal.css">
    <script src="js/state/settings-state.js"></script>
    <script src="js/systems/ui/settings-ui.js"></script>
    <script src="js/core/config/simulation-config.js"></script> <!-- NEW -->
    <script src="js/systems/ui/simulation-ui.js"></script> <!-- NEW -->
    <script src="js/systems/ui/location-display.js"></script>

    <!-- INPUT SYSTEM -->
    <script src="js/systems/input/gamepad-system.js"></script>

    <script src="js/systems/visual/electricity-system.js"></script>
    <script src="js/index.js"></script>
</body>

</html>